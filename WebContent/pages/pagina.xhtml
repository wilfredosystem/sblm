<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
	<link href="../resources/css/estilo.css" rel="stylesheet"
		type="text/css" />
	<script type="text/javascript">
		// 		function limpiarForm() {
		// 			document.getElementById("frmFormuPaginas").reset();
		// 		}
	</script>

	<title>SBLM</title>
</h:head>
<h:body>
	<ui:composition template="./paginaMaestra.xhtml">
		<ui:define name="content">


			<div class="contenidoPrincipal_FondoPrincipal">

				<div class="contenidoPrincipal_fondoIdentificador">
					<!-- TITULO SUBCONTENIDO -->
					<div class="administrador_paginasIcono"></div>
					<div class="contenidoPrincipal_SubContenido">
						<label class="contenidoPrincipal_lblTituloSubContenido">Administracion</label><br />
						<label class="contenidoPrincipal_lblSubTituloSubContenido">Paginas</label>
					</div>
				</div>
				<div class="contenidoPrincipal_SubFondo">

					<div class="administrador_paginasIconoSubcont"></div>
					<div id="lblSubtitulo"
						class="contenidoPrincipal_subFondo_lblTitulox">Paginas</div>
					<div class="contenidoPrincipal_fondo_formulario">
						<!-- CONTENIDO MODIFICABLE -->
						<div class="administrador_paginasContenedor">


							<div class="paginaInterior1">
								<h:form>
									<div class="btnNuevoRegistro">
										<p:commandLink update=":frmFormuPaginas"
											action="#{paginaMB.limpiarCampos}" style="margin-right:20px;">
											<p:graphicImage
												value="/resources/images/perfil/nuevo_mas.png"
												alt="Limpiar formulario" title="limpiar" />
										</p:commandLink>
									</div>
								</h:form>
								<h:form id="frmFormuPaginas">
								<p:growl id="growlRegitrar" showDetail="true" sticky="false" life="3000" />
									<div class="filaPagina">
										<h:outputLabel class="lblPagina" value="Pagina:" />
										<p:inputText styleClass="txtPagina" id="txtnombrePagina"
											value="#{paginaMB.pagina.nombrepagina}">
										</p:inputText>
									</div>
									<div class="filaDescripcionPagina">
										<h:outputLabel class="lblDescripcion" value="Descripcion:" />
										<p:inputText styleClass="txtDescripcion"
											id="txtDescripcionPagina"
											value="#{paginaMB.pagina.descripcionpagina}" />
									</div>
									<div class="filaEstadoPagina">
										<h:outputLabel class="lblEstadoPagina" value="Estado:" />
										<p:selectOneMenu id="cbxEstadoPagina"
											value="#{paginaMB.pagina.estado}" style="width: 190px;"
											onchange="console.log('selectOneMenu')">
											<f:selectItem itemLabel="Seleccione estado" itemValue="whr" />
											<f:selectItem itemLabel="Activo" itemValue="true" />
											<f:selectItem itemLabel="Inactivo" itemValue="false" />
										</p:selectOneMenu>
									</div>
									<div class="filaModuloPagina">
										<h:outputLabel class="lblModuloPagina" value="Modulo:" />
										<p:selectOneMenu id="cbxModuPagina" style="width: 190px;"
											value="#{paginaMB.pagina.modulo.idmodulo}" effect="fade"
											requiredMessage="Campo Obligatorio">
											<f:selectItem itemLabel="Seleccione responsable"
												itemValue="0" />
											<f:selectItems value="#{moduloMB.modulos}" var="modulo"
												itemLabel="#{modulo.nombremodulo}"
												itemValue="#{modulo.idmodulo}" />
										</p:selectOneMenu>

									</div>
									<div class="msgModulopagina">
										<p:message id="textOnlyMessage" for="cbxModuPagina"
											display="text" />
									</div>
									<div class="filaBotonModulo">
										<p:commandButton value="Guardar"
											oncomplete="validacioPagina();" id="btnregistroPagina" />
									</div>
								</h:form>
								<h:form id="frmdlgGuardarPagina">
									
									<p:confirmDialog message="¿Desea Guardar esta pagina?"
										header="Registro Pagina" severity="alert"
										widgetVar="dlgRegistrarPagina">

										<p:commandButton value="&nbsp;Aceptar"
											update=":frmTablaPaginas:tbPagina , :frmFormuPaginas,:frmMaestra"
											actionListener="#{paginaMB.registrarPagina}"
											oncomplete="dlgRegistrarPagina.hide()" image="icon-save">

										</p:commandButton>
										<p:commandButton value="&nbsp;Cancelar"
											update=":frmFormuPaginas "
											oncomplete="dlgRegistrarPagina.hide()" image="icon-cancel" />

									</p:confirmDialog>
								</h:form>
								<h:form id="frmTablaPaginas">
									<div class="paginaTabla">
										<p:dataTable id="tbPagina" var="pag"
											value="#{paginaMB.paginas}" rowKey="#{pag.idpagina}"
											selection="#{paginaMB.pagina}" selectionMode="single"
											paginator="true" rows="5" scrollable="true" scrollWidth="440"
											style="width:440px; font-size:10px;">
											<p:ajax event="rowSelect" listener="#{paginaMB.onRowSelect}"
												update=":frmFormuPaginas" />

											<p:column headerText="Modulo" style="text-align: center;">
												<h:outputText value="#{pag.modulo.nombremodulo}" />
											</p:column>
											<p:column headerText="Pagina" style="text-align: center;">
												<h:outputText value="#{pag.nombrepagina}" />
											</p:column>
											<p:column headerText="Descripcion" style="text-align: center;" width="120">
												<h:outputText value="#{pag.descripcionpagina}" />
											</p:column>
											<p:column headerText="Estado" style="text-align: center;" width="35">
												<h:outputText
													value="#{(pag.estado) ? 'Activo' : 'Inactivo'}" />
											</p:column>
											<p:column style="text-align: center;" width="30">

												<p:commandButton oncomplete="dlgEliminar.show();"
													update=":frmEliminar, :frmFormuPaginas" image="icon-delete" title="Eliminar">
													<f:setPropertyActionListener value="#{pag}"
														target="#{paginaMB.pagina}" />

												</p:commandButton>
											</p:column>
										</p:dataTable>
									</div>
								</h:form>
							</div>
							<h:form>
								<div class="paginaInterior2">
									<div class="administrador_paginasIconoInformacion"></div>
									<div class="lblInformacionPag">Informaci&oacute;n</div>
									<div class="lblUltimaPag">
										&Uacute;ltima p&aacute;gina creada
										<h:outputText style="font-size: 15px;color: #00c305;"
											value="#{paginaMB.ultimoPagina}" />
									</div>
									<div class="lblCreadorPag">
										Creador <br />
										<h:outputText value="#{usuarioMB.usuariologueado.nombres}" />
										&nbsp;
										<h:outputText value="#{usuarioMB.usuariologueado.apellidopat}" />
									</div>
									<div class="lblFotoCreadorPag">
										<p:graphicImage width="35" height="30"
											value="http://localhost:8080/sistemaSBLM/resources/images/usuarios/#{usuarioMB.usuariologueado.rutaimgusr}" />

									</div>
									<div class="lblDescripcionPagina">

										<p:commandLink oncomplete="dlg.show()"
											style="margin-right:20px;text-decoration: none; color: #0A246A ">
											Nota
										</p:commandLink>
										<p:dialog id="picture" widgetVar="dlg"
											header="Descripcion de Pagina" width="250" height="200"
											resizable="false" showEffect="clip" hideEffect="clip">

											<h:outputText
												value="Este modulo sirve para la creacion de paginas que se iran agregando al proyecto, para ello sera necesario crear el archivo con el mismo nombre de la pagina que se crea en esta seccion."></h:outputText>

										</p:dialog>
									</div>



								</div>
							</h:form>
							<h:form id="frmEliminar">
								<p:growl id="growlEliminar" showDetail="true" sticky="false" life="4000"  />
								<p:confirmDialog id="dlgEliminar"
									message="¿Desea eliminar este modulo?" header="Eliminar Modulo"
									severity="alert" widgetVar="dlgEliminar">

									<p:commandButton value="&nbsp;Aceptar"
										update=":frmTablaPaginas:tbPagina , growlEliminar,  :frmMaestra"
										actionListener="#{paginaMB.eliminarPagina}"
										oncomplete="dlgEliminar.hide()" image="icon-save">

									</p:commandButton>
									<p:commandButton value="&nbsp;Cancelar"
										update=":frmTablaPaginas:tbPagina "
										oncomplete="dlgEliminar.hide()" image="icon-cancel" />

								</p:confirmDialog>
							</h:form>
						</div>

					</div>

				</div>
			</div>

		</ui:define>
	</ui:composition>
</h:body>
</html>